<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width,,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no">
    <meta name="author" content="grissom">
    <meta name="description" content="JS跨域请求学习">
    <link rel="stylesheet" href="../frontend.css">
    <title>JS跨域请求学习</title>
</head>
<body>
    <p>学习</p>
    <div id="container" style="background-color: #3B9BE5;width: 200px;height: 200px" onclick="changeColor();">
        click to change color
    </div>
    <script>
//        document.domain = 'https://github.com'
    </script>
    <script>
        var container = document.getElementById('container');
        function changeColor() {
            container.style.backgroundColor = 'rgb(' + (Math.random()*255).toFixed(0) + ',' + (Math.random()*255).toFixed(0) + ',' + (Math.random()*255).toFixed(0) + ')';
            var color = container.style.backgroundColor;
            window.parent.postMessage(color,'https://bajie24.github.io/zhou-grissom/front-end/17/beyondDomain.html');
            console.log(window.parent);
        }
        window.addEventListener('message',function (e) {
            console.log(e);
            console.log(window.parent);
            var origin = event.origin || event.originalEvent.origin;
            if (origin !== "https://bajie24.github.io") return;
            var color = container.style.backgroundColor;
            console.log('1')
            window.parent.postMessage(color,'https://bajie24.github.io/zhou-grissom/front-end/17/beyondDomain.html');
        })
    </script>
</body>
</html>